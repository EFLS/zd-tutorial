<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-09-21 Wed 22:24 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Automated lists of links</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel='stylesheet' href='static/style.css' type='text/css'/>
</head>
<body>
<div id="preamble" class="status">
<div id='head'>
    <h1><b>zd-tutorial</b></h1>
    &mdash;
    <ul>
        <li><a href='./2020-02-15-1247 Welcome.html'>Welcome</a></li>
        <li><a href='https://efls.github.io/zetteldeft'
	       style='float: right'>Zetteldeft</a></li>
    </ul>
</div>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Automated lists of links</h1>
</header><p>
Backlink: <a href="./2020-04-17-1605 Expansions HUB.html">ยง2020-04-17-1605</a> Expansions HUB
</p>

<p>
Zetteldeft can generate lists of notes based on search terms, see <a href="./2020-04-17-1608 Generating lists of links.html">ยง2020-04-17-1608</a>.
</p>

<p>
To make updating these lists a little more convenient, you can create a function that you can then call straight from an org codeblock.
</p>

<p>
First, let&rsquo;s create an additional function:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b6a0ff; font-weight: bold;">defun</span> <span style="color: #feacd0;">efls/zetteldeft-links</span> (str <span style="color: #6ae4b9; font-weight: bold;">&amp;optional</span> missing silent)
  <span style="color: #b0d6f5;">"Crude attempt to automate `</span><span style="color: #00bcff;">zetteldeft-insert-list-links-missing</span><span style="color: #b0d6f5;">'.</span>
<span style="color: #b0d6f5;">Meant to be called from a source block.</span>
<span style="color: #b0d6f5;">Replaces the list below the block with an updated list.</span>
<span style="color: #b0d6f5;">When MISSING is t, use `</span><span style="color: #00bcff;">zetteldeft-insert-list-links-missing</span><span style="color: #b0d6f5;">'.</span>
<span style="color: #b0d6f5;">With MISSING as t, suppress the timestamp at the end."</span>
  (<span style="color: #b6a0ff; font-weight: bold;">save-excursion</span>
    (org-forward-element)
    <span style="color: #bec2ca;">; </span><span style="color: #bec2ca;">Delete any existing list</span>
    (<span style="color: #b6a0ff; font-weight: bold;">when</span> (org-in-item-p) (delete-region (point) (org-end-of-item-list)))
    <span style="color: #bec2ca;">; </span><span style="color: #bec2ca;">New line &amp; insert links</span>
    (<span style="color: #b6a0ff; font-weight: bold;">if</span> missing
        (<span style="color: #b6a0ff; font-weight: bold;">progn</span> 
          (save-buffer)
          (deft-refresh)
          (zetteldeft-insert-list-links-missing str))
      (zetteldeft-insert-list-links str))
    (<span style="color: #b6a0ff; font-weight: bold;">unless</span> silent
      (org-return-indent)
      (insert (current-time-string) <span style="color: #79a8ff;">"\n"</span>))))
</pre>
</div>

<p>
Like it says in the doc string, this function is meant to be called from an org code block.
Try it for yourself by first executing the block above, and then the one below (with <code>C-c C-c</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(efls/zetteldeft-links <span style="color: #79a8ff;">"#zetteldeft"</span>)
</pre>
</div>

<p>
Neat huh?
</p>

<p>
As an aside: we can use this function to generate a list of backlinks (i.e., link to notes that link to the current note).
See <a href="./2020-08-29-1223 List of backlinks.html">ยง2020-08-29-1223</a> for details.
</p>

<p>
To further automate this, we can introduce a final function that generates the code block above.
It asks for a search term and then generates the source block.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b6a0ff; font-weight: bold;">defun</span> <span style="color: #feacd0;">efls/zetteldeft-links-codeblock</span> (str)
  <span style="color: #b0d6f5;">"Ask for a STR to search, and insert an org-mode</span>
<span style="color: #b0d6f5;">source block that calls `</span><span style="color: #00bcff;">efls/zetteldeft-links</span><span style="color: #b0d6f5;">'.</span>
<span style="color: #b0d6f5;">When called with a prefix, pass t to said function."</span>
  (<span style="color: #b6a0ff; font-weight: bold;">interactive</span>
    (list (read-string <span style="color: #79a8ff;">"Search: "</span>)))
  (newline)
  (insert <span style="color: #79a8ff;">"#+BEGIN_SRC emacs-lisp :results silent\n"</span>
          <span style="color: #79a8ff;">"(efls/zetteldeft-links \""</span> str<span style="color: #79a8ff;">"\""</span>)
  (<span style="color: #b6a0ff; font-weight: bold;">when</span> current-prefix-arg (insert <span style="color: #79a8ff;">" t"</span>))
  (insert <span style="color: #79a8ff;">")\n"</span>
          <span style="color: #79a8ff;">"#+END_SRC\n"</span>))
</pre>
</div>

<p>
And with a prefix, it makes sure only missing links are added (by calling <code>zetteldeft-insert-list-links-missing</code>).
</p>
</div>
</body>
</html>
